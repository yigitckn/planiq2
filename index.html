<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlanIQ - AkÄ±llÄ± GÃ¼nlÃ¼k PlanlayÄ±cÄ±</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fadeIn {
            0% { opacity: 0; }
            100% { opacity: 1; }
        }
        @keyframes slideUp {
            0% { transform: translateY(20px); opacity: 0; }
            100% { transform: translateY(0); opacity: 1; }
        }
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0,0,0); }
            40%, 43% { transform: translate3d(0, -30px, 0); }
            70% { transform: translate3d(0, -15px, 0); }
            90% { transform: translate3d(0, -4px, 0); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .animate-fadeIn { animation: fadeIn 0.2s ease-out; }
        .animate-slideUp { animation: slideUp 0.5s ease-out; }
        .animate-bounce { animation: bounce 1.5s ease-in-out infinite; }
        .animate-pulse { animation: pulse 2s ease-in-out infinite; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useRef, useEffect } = React;
        
        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyARs7TFmAOSq88lTgYSlUJjGoQP_rt9SwA",
            authDomain: "planiq-170ca.firebaseapp.com",
            projectId: "planiq-170ca",
            storageBucket: "planiq-170ca.firebasestorage.app",
            messagingSenderId: "110643251007",
            appId: "1:110643251007:web:28d01c098db5f74280358a",
            measurementId: "G-VZJR3XE0XT"
        };
        
        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        
        // Helper Functions
        const formatDateKey = (date) => {
            if (!(date instanceof Date) || isNaN(date)) {
                return new Date().toISOString().split('T')[0];
            }
            return date.toISOString().split('T')[0];
        };
        
        const formatFullDate = (date) => {
            if (!(date instanceof Date) || isNaN(date)) {
                date = new Date();
            }
            return new Intl.DateTimeFormat('tr-TR', { day: 'numeric', month: 'long', weekday: 'long' }).format(date);
        };
        
        const formatDisplayDate = (date) => {
            if (!(date instanceof Date) || isNaN(date)) {
                date = new Date();
            }
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            const tomorrow = new Date(today);
            tomorrow.setDate(today.getDate() + 1);
            const yesterday = new Date(today);
            yesterday.setDate(today.getDate() - 1);
            
            const targetDate = new Date(date);
            targetDate.setHours(0, 0, 0, 0);
            
            if (targetDate.getTime() === today.getTime()) return "BugÃ¼n";
            if (targetDate.getTime() === tomorrow.getTime()) return "YarÄ±n";
            if (targetDate.getTime() === yesterday.getTime()) return "DÃ¼n";
            
            const day = String(targetDate.getDate()).padStart(2, '0');
            const month = String(targetDate.getMonth() + 1).padStart(2, '0');
            return `${day}/${month}`;
        };
        
        const parseTime = (timeString) => {
            if (!timeString || !timeString.includes(':')) return null;
            const [hours, minutes] = timeString.split(':').map(Number);
            if (isNaN(hours) || isNaN(minutes)) return null;
            return { hours, minutes };
        };
        
        const isTimeLaterOrEqual = (time1, time2) => {
            const t1 = parseTime(time1);
            const t2 = parseTime(time2);
            if (!t1 || !t2) return false;
            if (t1.hours > t2.hours) return true;
            if (t1.hours === t2.hours && t1.minutes >= t2.minutes) return true;
            return false;
        };
        
        const addMinutesToTime = (timeString, minutesToAdd) => {
            const time = parseTime(timeString);
            if (!time) return timeString;
            
            let totalMinutes = time.hours * 60 + time.minutes + minutesToAdd;
            totalMinutes = (totalMinutes + 1440) % 1440;
            
            const newHours = Math.floor(totalMinutes / 60);
            const newMinutes = totalMinutes % 60;
            
            return `${String(newHours).padStart(2, '0')}:${String(newMinutes).padStart(2, '0')}`;
        };
        
        // Splash Screen Component
        const SplashScreen = () => {
            return React.createElement('div', {
                className: "fixed inset-0 bg-gradient-to-br from-purple-600 via-purple-500 to-pink-500 flex items-center justify-center z-50 overflow-hidden"
            }, [
                React.createElement('div', {
                    key: 'bubbles',
                    className: "absolute top-1/4 left-1/4 w-48 h-48 bg-white/10 rounded-full filter blur-3xl animate-pulse"
                }),
                React.createElement('div', {
                    key: 'bubbles2',
                    className: "absolute bottom-1/4 right-1/4 w-32 h-32 bg-white/10 rounded-full filter blur-3xl animate-pulse"
                }),
                React.createElement('div', {
                    key: 'content',
                    className: "text-center animate-fadeIn relative z-10"
                }, [
                    React.createElement('div', {
                        key: 'logo',
                        className: "mb-6 animate-bounce"
                    }, React.createElement('div', {
                        className: "w-32 h-32 bg-white rounded-3xl shadow-2xl flex items-center justify-center mx-auto transform transition-transform duration-500 hover:scale-110"
                    }, React.createElement('div', {
                        className: "w-20 h-20 text-purple-600 animate-pulse"
                    }, 'ğŸ§ '))),
                    React.createElement('h1', {
                        key: 'title',
                        className: "text-6xl font-bold text-white mb-4 animate-slideUp"
                    }, [
                        'Plan',
                        React.createElement('span', {
                            key: 'iq',
                            className: "text-yellow-300"
                        }, 'IQ')
                    ]),
                    React.createElement('p', {
                        key: 'subtitle',
                        className: "text-white/90 text-xl animate-slideUp"
                    }, 'AkÄ±llÄ± GÃ¼nlÃ¼k PlanlayÄ±cÄ±n')
                ])
            ]);
        };
        
        // DailyPlanCard Component
        const DailyPlanCard = ({ day, userData, selectedDateKey, userId, isDark }) => {
            const [tasks, setTasks] = useState([]);
            const [isLoadingTasks, setIsLoadingTasks] = useState(true);
            const [isAddingTask, setIsAddingTask] = useState(false);
            const [newTask, setNewTask] = useState({ time: '', name: '' });
            const [modalTask, setModalTask] = useState(null);
            const [modalContentStage, setModalContentStage] = useState('initial');
            const [aiSuggestionContent, setAiSuggestionContent] = useState(null);
            
            // GerÃ§ek AI tarif Ã¶neri fonksiyonu
            const generateRecipeSuggestions = async (mealType, cuisine, userCuisines) => {
                try {
                    // AI iÃ§in tarif Ã¶nerisi
                    const generateAIRecipe = async (prompt) => {
                        try {
                            // Gemini AI API - Google Search ile gerÃ§ek tarifler
                            console.log('Gemini AI + Google Search tarif Ã¶nerileri Ã§alÄ±ÅŸÄ±yor...');
                            
                            const geminiResponse = await fetch('/.netlify/functions/gemini-proxy', {
                              method: 'POST',
                              headers: { 'Content-Type': 'application/json' },
                              body: JSON.stringify({ prompt })
                            });

                            if (geminiResponse.ok) {
                                const data = await geminiResponse.json();
                                console.log('Gemini API Response:', data);
                                
                                if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts) {
                                    const result = data.candidates[0].content.parts[0].text;
                                    console.log('Gemini AI Success:', result);
                                    return result;
                                }
                            } else {
                                console.log('Gemini API Error:', geminiResponse.status, await geminiResponse.text());
                            }
                        } catch (error) {
                            console.log('Gemini AI failed:', error);
                        }

                        // Fallback: Mock AI (API Ã§alÄ±ÅŸmazsa)
                        console.log('Fallback Mock AI tarif Ã¶nerileri Ã§alÄ±ÅŸÄ±yor...');
                        
                        // Ã–ÄŸÃ¼n tipini Ã§Ä±kar - daha kesin kontrol
                        let mealType = 'kahvaltÄ±'; // varsayÄ±lan
                        if (prompt.includes('Ã¶ÄŸle yemeÄŸi') || prompt.includes('Ã¶ÄŸle')) {
                            mealType = 'Ã¶ÄŸle yemeÄŸi';
                        } else if (prompt.includes('akÅŸam yemeÄŸi') || prompt.includes('akÅŸam')) {
                            mealType = 'akÅŸam yemeÄŸi';
                        } else if (prompt.includes('kahvaltÄ±')) {
                            mealType = 'kahvaltÄ±';
                        }
                        
                        console.log('AlgÄ±lanan Ã¶ÄŸÃ¼n tipi:', mealType);
                        
                        // Mutfak tipini Ã§Ä±kar
                        const cuisine = prompt.includes('TÃ¼rk') ? 'TÃ¼rk' : 
                                      prompt.includes('Ä°talyan') ? 'Ä°talyan' : 
                                      prompt.includes('Uzak DoÄŸu') ? 'Uzak DoÄŸu' : 'genel';
                        
                        // GerÃ§ekÃ§i tarif Ã¶nerileri oluÅŸtur - kÄ±sa ve Ã¶z
                        const mockRecipes = {
                            'kahvaltÄ±': [
                                `Menemen:\nTaze domates, biber ve yumurta ile hazÄ±rlanan TÃ¼rk kahvaltÄ±sÄ±nÄ±n vazgeÃ§ilmez lezzeti. 15 dakikada hazÄ±r.`,
                                `Omlet:\nKlasik yumurta yemeÄŸi, taze otlar ve peynirle zenginleÅŸtirilmiÅŸ. 10 dakikada hazÄ±r.`,
                                `Serpme KahvaltÄ±:\nPeynir, zeytin, domates, salatalÄ±k ve reÃ§el ile hazÄ±rlanan geleneksel TÃ¼rk kahvaltÄ±sÄ±.`,
                                `Avokado Tost:\nTaze avokado, limon ve tuz ile hazÄ±rlanan modern kahvaltÄ±. 5 dakikada hazÄ±r.`,
                                `Yulaf Ezmesi:\nSÃ¼t ile piÅŸirilen yulaf, taze meyveler ve bal ile tatlandÄ±rÄ±lmÄ±ÅŸ. 10 dakikada hazÄ±r.`
                            ],
                            'Ã¶ÄŸle yemeÄŸi': [
                                `Kebap:\nGeleneksel TÃ¼rk kebap Ã§eÅŸitleri, taze et ve baharatlarla hazÄ±rlanan. 30 dakikada hazÄ±r.`,
                                `MantÄ±:\nHamur iÃ§i et ile doldurulmuÅŸ, yoÄŸurt sosu ile servis edilen. 45 dakikada hazÄ±r.`,
                                `Lahmacun:\nÄ°nce hamur Ã¼zerine kÄ±yma, domates ve baharatlarla hazÄ±rlanan. 25 dakikada hazÄ±r.`,
                                `Ã‡orba:\nSÄ±cak ve besleyici Ã§orba Ã§eÅŸitleri. 20 dakikada hazÄ±r.`,
                                `Salata:\nTaze yeÅŸillikler, sebzeler ve protein kaynaklarÄ± ile hazÄ±rlanan. 15 dakikada hazÄ±r.`,
                                `SandviÃ§:\nEkmek arasÄ± taze malzemelerle hazÄ±rlanan pratik yemek. 10 dakikada hazÄ±r.`
                            ],
                            'akÅŸam yemeÄŸi': [
                                `Kuzu TandÄ±r:\nUzun sÃ¼re piÅŸirilen kuzu eti, geleneksel TÃ¼rk mutfaÄŸÄ±nÄ±n Ã¶zel lezzeti. 2 saatte hazÄ±r.`,
                                `BalÄ±k:\nTaze balÄ±k Ã§eÅŸitleri, zeytinyaÄŸÄ± ve limon ile hazÄ±rlanan. 30 dakikada hazÄ±r.`,
                                `Pasta:\nMakarna Ã§eÅŸitleri, Ã§eÅŸitli soslarla hazÄ±rlanan doyurucu yemek. 25 dakikada hazÄ±r.`,
                                `Et YemeÄŸi:\nTavuk, dana veya kuzu eti ile hazÄ±rlanan protein aÃ§Ä±sÄ±ndan zengin yemek. 45 dakikada hazÄ±r.`,
                                `Sebze YemeÄŸi:\nTaze sebzelerle hazÄ±rlanan hafif ve saÄŸlÄ±klÄ± yemek. 20 dakikada hazÄ±r.`,
                                `Pilav:\nPirinÃ§ pilavÄ±, et suyu ile hazÄ±rlanan geleneksel yan yemek. 30 dakikada hazÄ±r.`
                            ]
                        };
                        
                        // Rastgele 3-4 tarif seÃ§
                        const recipes = mockRecipes[mealType] || mockRecipes['kahvaltÄ±'];
                        const selectedRecipes = recipes.sort(() => 0.5 - Math.random()).slice(0, 3);
                        
                        // AI yanÄ±tÄ± formatÄ±nda dÃ¶ndÃ¼r
                        return selectedRecipes.join('\n\n');
                    };
                    
                    // AI iÃ§in prompt oluÅŸtur
                    const cuisineText = userCuisines && userCuisines.length > 0 
                        ? `KullanÄ±cÄ±nÄ±n sevdiÄŸi mutfaklar: ${userCuisines.join(', ')}` 
                        : 'Genel mutfak';
                    
                    const mealTypeTurkish = {
                        'kahvaltÄ±': 'kahvaltÄ±',
                        'Ã¶ÄŸle yemeÄŸi': 'Ã¶ÄŸle yemeÄŸi', 
                        'akÅŸam yemeÄŸi': 'akÅŸam yemeÄŸi'
                    };
                    
                    const currentMealType = mealTypeTurkish[mealType] || mealType;
                    
                    const aiPrompt = `${currentMealType} iÃ§in ${cuisineText} tarifleri Ã¶ner. 
                    LÃ¼tfen 2-3 farklÄ± lezzetli tarif Ã¶ner, her birinin adÄ±nÄ± ve detaylÄ± aÃ§Ä±klamasÄ±nÄ± ver. 
                    Format: 
                    "Tarif AdÄ±:
                    AÃ§Ä±klama: [Tarifin malzemelerini, hazÄ±rlanÄ±ÅŸÄ±nÄ±, Ã¶zelliklerini detaylÄ±ca anlat]"
                    
                    Ã–rnek:
                    "Menemen:
                    AÃ§Ä±klama: Domates, biber ve yumurta ile hazÄ±rlanan, TÃ¼rk kahvaltÄ±larÄ±nÄ±n vazgeÃ§ilmez lezzeti. Taze domates ve biberlerin kavrulmasÄ±yla hazÄ±rlanan bu pratik yemek, doyurucu ve besleyicidir."
                    
                    Sadece tarif isimlerini ve aÃ§Ä±klamalarÄ±nÄ± ver, baÅŸka aÃ§Ä±klama yapma.`;
                    
                    // AI'dan tarif al
                    const aiResponse = await generateAIRecipe(aiPrompt);
                    
                    if (aiResponse) {
                        // AI yanÄ±tÄ±nÄ± parse et - tarif adÄ± ve aÃ§Ä±klama formatÄ±nda
                        const lines = aiResponse.split('\n').filter(line => line.trim());
                        const suggestions = [];
                        let currentRecipe = null;
                        
                        for (let i = 0; i < lines.length; i++) {
                            const line = lines[i].trim();
                            
                            // Tarif adÄ± (AÃ§Ä±klama: ile bitmeyen satÄ±rlar)
                            if (line && !line.startsWith('AÃ§Ä±klama:') && !line.match(/^\d+\./)) {
                                if (currentRecipe) {
                                    suggestions.push(currentRecipe);
                                }
                                currentRecipe = {
                                    name: line.replace(/^[-â€¢*]\s*/, ''),
                                    description: ''
                                };
                            }
                            // AÃ§Ä±klama
                            else if (line.startsWith('AÃ§Ä±klama:') && currentRecipe) {
                                currentRecipe.description = line.replace('AÃ§Ä±klama:', '').trim();
                            }
                        }
                        
                        // Son tarifi ekle
                        if (currentRecipe) {
                            suggestions.push(currentRecipe);
                        }
                        
                        if (suggestions.length > 0) {
                            return suggestions.map(s => `${s.name}:\n${s.description}`);
                        }
                    }
                    
                    // Fallback: Statik tarifler
                    const recipes = mockRecipes[mealType] || mockRecipes['kahvaltÄ±'];
const selectedRecipes = recipes.sort(() => 0.5 - Math.random()).slice(0, 3);

// AI yanÄ±tÄ± formatÄ±nda dÃ¶ndÃ¼r
return selectedRecipes.join('\n\n');
                
                } catch (error) {
                    console.error('Tarif Ã¶neri hatasÄ±:', error);
                    // Hata durumunda genel Ã¶neriler
                    return ['Omlet', 'Menemen', 'Yulaf Ezmesi']; 
                }
            };
            
            // GerÃ§ek AI restoran Ã¶neri fonksiyonu
            const generateRestaurantSuggestions = async (mealType, city, userCuisines) => {
                console.log('generateRestaurantSuggestions Ã§aÄŸrÄ±ldÄ±:', { mealType, city, userCuisines });
                try {
                    // OpenAI API entegrasyonu iÃ§in
                    const generateAIRecommendations = async (prompt) => {
                        try {
                            // Netlify Functions proxy Ã¼zerinden Gemini AI Ã§aÄŸrÄ±sÄ±
                            const geminiResponse = await fetch('/.netlify/functions/gemini-proxy', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ prompt })
                            });

                            if (geminiResponse.ok) {
                                const data = await geminiResponse.json();
                                if (data.success) {
                                    return data.result;
                                } else if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts) {
                                    return data.candidates[0].content.parts[0].text;
                                }
                            } else {
                                throw new Error('Gemini API Error: ' + geminiResponse.status);
                            }
                        } catch(e) {
                            console.error('Gemini AI Restaurant HatasÄ±:', e);
                            return null;
                        }
                    };
                    
                    // OpenAI API'yi dene (CORS proxy ile)
                    console.log('OpenAI API + CORS proxy Ã§alÄ±ÅŸÄ±yor...');
                    
                    const openaiResponse = await fetch('https://api.openai.com/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${localStorage.getItem('openai_api_key') || 'sk-proj-placeholder'}`
                        },
                        body: JSON.stringify({
                            model: 'gpt-3.5-turbo',
                            messages: [
                                {
                                    role: 'system',
                                    content: 'Sen bir restoran Ã¶neri uzmanÄ±sÄ±n. KullanÄ±cÄ±nÄ±n ÅŸehrine Ã¶zel gerÃ§ek restoran isimleri ve aÃ§Ä±klamalarÄ± ver.'
                                },
                                {
                                    role: 'user',
                                    content: prompt
                                }
                            ],
                            max_tokens: 500,
                            temperature: 0.7
                        })
                    });

                    if (geminiResponse.ok) {
                        const data = await geminiResponse.json();
                        console.log('Gemini API Response:', data);
                        
                        if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts) {
                            const result = data.candidates[0].content.parts[0].text;
                            console.log('Gemini AI Success:', result);
                            return result;
                        }
                    } else {
                        console.log('Gemini API Error:', geminiResponse.status, await geminiResponse.text());
                    }
                } catch (error) {
                    console.log('Gemini AI failed:', error);
                }

                // Fallback: GÃ¼Ã§lÃ¼ Mock AI (API Ã§alÄ±ÅŸmazsa)
                console.log('Fallback Mock AI Ã§alÄ±ÅŸÄ±yor...');
                
                const locationMatch = prompt.match(/(\w+)\s+ÅŸehrinde/);
                const city = locationMatch ? locationMatch[1] : 'Ä°stanbul';
                
                let mealType = 'kahvaltÄ±';
                if (prompt.includes('Ã¶ÄŸle yemeÄŸi') || prompt.includes('Ã¶ÄŸle')) {
                    mealType = 'Ã¶ÄŸle yemeÄŸi';
                } else if (prompt.includes('akÅŸam yemeÄŸi') || prompt.includes('akÅŸam')) {
                    mealType = 'akÅŸam yemeÄŸi';
                } else if (prompt.includes('kahvaltÄ±')) {
                    mealType = 'kahvaltÄ±';
                }
                
                // AkÄ±llÄ± Mock AI - KullanÄ±cÄ±nÄ±n ÅŸehrine gÃ¶re Ã¶zel Ã¶neriler
                const generateCitySpecificRestaurants = (city, mealType) => {
                    const cityLower = city.toLowerCase();
                    
                    // Åehir bazlÄ± Ã¶zel restoran isimleri
                    const cityRestaurants = {
                        'istanbul': {
                            'kahvaltÄ±': [
                                `Van KahvaltÄ± Evi:\nBeÅŸiktaÅŸ'ta geleneksel TÃ¼rk kahvaltÄ±sÄ±nÄ±n en gÃ¼zel Ã¶rneklerini sunan popÃ¼ler mekan.`,
                                `Ã‡akÄ±r KahvaltÄ±:\nÅiÅŸli'de serpme kahvaltÄ± geleneÄŸini yaÅŸatan, doÄŸal Ã¼rÃ¼nlerle hazÄ±rlanan lezzetli mekan.`,
                                `Mado KahvaltÄ±:\nKadÄ±kÃ¶y'de modern kahvaltÄ± seÃ§enekleri sunan, geniÅŸ menÃ¼ Ã§eÅŸitliliÄŸi olan popÃ¼ler mekan.`,
                                `Bebek KahvaltÄ±:\nBebek'te deniz manzaralÄ± kahvaltÄ± deneyimi sunan ÅŸÄ±k mekan.`,
                                `KarakÃ¶y GÃ¼llÃ¼oÄŸlu:\nKarakÃ¶y'de geleneksel TÃ¼rk tatlÄ±larÄ± ve kahvaltÄ± sunan Ã¼nlÃ¼ mekan.`
                            ],
                            'Ã¶ÄŸle yemeÄŸi': [
                                `HacÄ± Abdullah:\nBeyoÄŸlu'nda geleneksel TÃ¼rk mutfaÄŸÄ± sunan, Ã¶zellikle kebap Ã§eÅŸitleriyle Ã¼nlÃ¼ popÃ¼ler mekan.`,
                                `Ã‡iya SofrasÄ±:\nKadÄ±kÃ¶y'de Anadolu mutfak kÃ¼ltÃ¼rÃ¼nÃ¼ yansÄ±tan, geleneksel yemekleri modern sunumla birleÅŸtiren restoran.`,
                                `KÃ¶fteci Ramiz:\nFatih'te kÃ¶fte ve Ä±zgara Ã§eÅŸitleriyle Ã¼nlÃ¼, hÄ±zlÄ± servisi olan popÃ¼ler mekan.`,
                                `Zeytin DalÄ±:\nEtiler'de Akdeniz mutfaÄŸÄ± sunan ÅŸÄ±k restoran.`,
                                `AsmalÄ± Mescit:\nBeyoÄŸlu'nda geleneksel TÃ¼rk mutfaÄŸÄ± sunan tarihi mekan.`
                            ],
                            'akÅŸam yemeÄŸi': [
                                `Mikla:\nBeyoÄŸlu'nda fine dining deneyimi sunan, ÅŸÄ±k atmosferi ve Ã¶zel akÅŸam menÃ¼leriyle Ã¼nlÃ¼ romantik restoran.`,
                                `Neolokal:\nBeyoÄŸlu'nda modern TÃ¼rk mutfaÄŸÄ± sunan, akÅŸam yemeÄŸi iÃ§in Ã¶zel menÃ¼leri olan ÅŸÄ±k mekan.`,
                                `Sunset Grill & Bar:\nEtiler'de manzaralÄ±, akÅŸam yemeÄŸi iÃ§in mÃ¼kemmel atmosfer sunan lÃ¼ks restoran.`,
                                `Lokanta 1741:\nBeyoÄŸlu'nda geleneksel OsmanlÄ± mutfaÄŸÄ± sunan ÅŸÄ±k restoran.`,
                                `TÃ¼rk Fatih Tutak:\nÅiÅŸli'de modern TÃ¼rk mutfaÄŸÄ± sunan Michelin yÄ±ldÄ±zlÄ± restoran.`
                            ]
                        },
                        'ankara': {
                            'kahvaltÄ±': [
                                `KÄ±zÄ±lay KahvaltÄ± Evi:\nKÄ±zÄ±lay'da geleneksel TÃ¼rk kahvaltÄ±sÄ± sunan, sÄ±cak atmosferi olan popÃ¼ler mekan.`,
                                `Ã‡ankaya KahvaltÄ±:\nÃ‡ankaya'da modern kahvaltÄ± seÃ§enekleri sunan, geniÅŸ menÃ¼ Ã§eÅŸitliliÄŸi olan mekan.`,
                                `Ulus KahvaltÄ± Salonu:\nUlus'ta serpme kahvaltÄ± geleneÄŸini yaÅŸatan, doÄŸal Ã¼rÃ¼nlerle hazÄ±rlanan lezzetli mekan.`,
                                `BahÃ§elievler KahvaltÄ±:\nBahÃ§elievler'de taze malzemelerle hazÄ±rlanan kahvaltÄ± sunan mekan.`,
                                `TunalÄ± KahvaltÄ±:\nTunalÄ±'da Ã§aÄŸdaÅŸ kahvaltÄ± seÃ§enekleri sunan ÅŸÄ±k mekan.`
                            ],
                            'Ã¶ÄŸle yemeÄŸi': [
                                `Ankara Kebap Evi:\nUlus'ta geleneksel TÃ¼rk mutfaÄŸÄ± sunan, Ã¶zellikle kebap Ã§eÅŸitleriyle Ã¼nlÃ¼ popÃ¼ler mekan.`,
                                `Ã‡ankaya SofrasÄ±:\nÃ‡ankaya'da Anadolu mutfak kÃ¼ltÃ¼rÃ¼nÃ¼ yansÄ±tan, geleneksel yemekleri modern sunumla birleÅŸtiren restoran.`,
                                `KÄ±zÄ±lay LokantasÄ±:\nKÄ±zÄ±lay'da ev yemekleri ve geleneksel lezzetler sunan, hÄ±zlÄ± servisi olan popÃ¼ler mekan.`,
                                `BahÃ§elievler Kebap:\nBahÃ§elievler'de kebap Ã§eÅŸitleri sunan popÃ¼ler restoran.`,
                                `TunalÄ± Modern:\nTunalÄ±'da Ã§aÄŸdaÅŸ lezzetler sunan ÅŸÄ±k mekan.`
                            ],
                            'akÅŸam yemeÄŸi': [
                                `Ankara Fine Dining:\nÃ‡ankaya'da Ã¶zel akÅŸam menÃ¼leri ve ÅŸÄ±k atmosferi olan romantik restoran.`,
                                `Ã‡ankaya Modern:\nÃ‡ankaya'da Ã§aÄŸdaÅŸ lezzetler ve yenilikÃ§i sunumlar sunan ÅŸÄ±k mekan.`,
                                `Ulus Geleneksel:\nUlus'ta yerel mutfaÄŸÄ±n en gÃ¼zel Ã¶rneklerini sunan otantik mekan.`,
                                `KÄ±zÄ±lay AkÅŸam:\nKÄ±zÄ±lay'da romantik atmosferi olan ÅŸÄ±k akÅŸam mekanÄ±.`,
                                `TunalÄ± AkÅŸam:\nTunalÄ±'da Ã§aÄŸdaÅŸ lezzetler sunan ÅŸÄ±k akÅŸam mekanÄ±.`
                            ]
                        },
                        'izmir': {
                            'kahvaltÄ±': [
                                `Konak KahvaltÄ± Evi:\n${city} bÃ¶lgesinde Ege mutfaÄŸÄ±nÄ±n lezzetlerini sunan, deniz manzaralÄ± popÃ¼ler mekan.`,
                                `Alsancak KahvaltÄ±:\n${city} bÃ¶lgesinde modern kahvaltÄ± seÃ§enekleri sunan, geniÅŸ menÃ¼ Ã§eÅŸitliliÄŸi olan mekan.`,
                                `Bornova KahvaltÄ± Salonu:\n${city} bÃ¶lgesinde serpme kahvaltÄ± geleneÄŸini yaÅŸatan, doÄŸal Ã¼rÃ¼nlerle hazÄ±rlanan lezzetli mekan.`
                            ],
                            'Ã¶ÄŸle yemeÄŸi': [
                                `Ä°zmir Kebap Evi:\n${city} bÃ¶lgesinde geleneksel TÃ¼rk mutfaÄŸÄ± sunan, Ã¶zellikle kebap Ã§eÅŸitleriyle Ã¼nlÃ¼ popÃ¼ler mekan.`,
                                `Ege SofrasÄ±:\n${city} bÃ¶lgesinde Ege mutfak kÃ¼ltÃ¼rÃ¼nÃ¼ yansÄ±tan, geleneksel yemekleri modern sunumla birleÅŸtiren restoran.`,
                                `Konak LokantasÄ±:\n${city} bÃ¶lgesinde ev yemekleri ve geleneksel lezzetler sunan, hÄ±zlÄ± servisi olan popÃ¼ler mekan.`
                            ],
                            'akÅŸam yemeÄŸi': [
                                `Ä°zmir Fine Dining:\n${city} bÃ¶lgesinde Ã¶zel akÅŸam menÃ¼leri ve ÅŸÄ±k atmosferi olan romantik restoran.`,
                                `Alsancak Modern:\n${city} bÃ¶lgesinde Ã§aÄŸdaÅŸ lezzetler ve yenilikÃ§i sunumlar sunan ÅŸÄ±k mekan.`,
                                `Bornova Geleneksel:\n${city} bÃ¶lgesinde yerel mutfaÄŸÄ±n en gÃ¼zel Ã¶rneklerini sunan otantik mekan.`
                            ]
                        },
                        'kaÄŸÄ±thane': {
                            'kahvaltÄ±': [
                                `KaÄŸÄ±thane KahvaltÄ± Evi:\n${city} bÃ¶lgesinde taze malzemelerle hazÄ±rlanan geleneksel kahvaltÄ± lezzetleri sunan, sÄ±cak ve samimi atmosferi olan popÃ¼ler mekan.`,
                                `Modern Kafe:\n${city} bÃ¶lgesinde uluslararasÄ± kahvaltÄ± seÃ§enekleri ve kaliteli kahve Ã§eÅŸitleri sunan, Ã§aÄŸdaÅŸ tasarÄ±mÄ± olan popÃ¼ler mekan.`,
                                `Geleneksel Restoran:\n${city} bÃ¶lgesinde yerel mutfaÄŸÄ±n en gÃ¼zel Ã¶rneklerini sunan, otantik atmosferi olan popÃ¼ler mekan.`
                            ],
                            'Ã¶ÄŸle yemeÄŸi': [
                                `KaÄŸÄ±thane Kebap Evi:\n${city} bÃ¶lgesinde geleneksel TÃ¼rk mutfaÄŸÄ± sunan, Ã¶zellikle kebap Ã§eÅŸitleriyle Ã¼nlÃ¼ popÃ¼ler mekan.`,
                                `HÄ±zlÄ± Servis:\n${city} bÃ¶lgesinde pratik Ã¶ÄŸle yemeÄŸi seÃ§enekleri sunan, hÄ±zlÄ± servisi olan popÃ¼ler mekan.`,
                                `Ev Yemekleri:\n${city} bÃ¶lgesinde sÄ±cak yemek seÃ§enekleri sunan, ev yemeÄŸi tadÄ±nda lezzetler.`
                            ],
                            'akÅŸam yemeÄŸi': [
                                `KaÄŸÄ±thane Fine Dining:\n${city} bÃ¶lgesinde Ã¶zel akÅŸam menÃ¼leri ve ÅŸÄ±k atmosferi olan romantik restoran.`,
                                `Modern Mutfak:\n${city} bÃ¶lgesinde Ã§aÄŸdaÅŸ lezzetler ve yenilikÃ§i sunumlar sunan ÅŸÄ±k mekan.`,
                                `Geleneksel Restoran:\n${city} bÃ¶lgesinde yerel mutfaÄŸÄ±n en gÃ¼zel Ã¶rneklerini sunan otantik mekan.`
                            ]
                        }
                    };
                    
                    // Åehir algÄ±lama
                    let cityKey = 'istanbul'; // varsayÄ±lan
                    if (cityLower.includes('ankara') || cityLower.includes('Ã§ankaya') || cityLower.includes('kÄ±zÄ±lay')) {
                        cityKey = 'ankara';
                    } else if (cityLower.includes('izmir') || cityLower.includes('konak') || cityLower.includes('alsancak')) {
                        cityKey = 'izmir';
                    } else if (cityLower.includes('kaÄŸÄ±thane') || cityLower.includes('kaÄŸÄ±thane')) {
                        cityKey = 'kaÄŸÄ±thane';
                    } else if (cityLower.includes('sarÄ±yer') || cityLower.includes('sariyer')) {
                        cityKey = 'sarÄ±yer';
                    } else if (cityLower.includes('istanbul') || cityLower.includes('beÅŸiktaÅŸ') || cityLower.includes('ÅŸiÅŸli') || cityLower.includes('kadÄ±kÃ¶y')) {
                        cityKey = 'istanbul';
                    }
                    
                    return cityRestaurants[cityKey]?.[mealType] || cityRestaurants['istanbul']['kahvaltÄ±'];
                };
                
                const responses = generateCitySpecificRestaurants(city, mealType);
                const selectedResponses = responses.sort(() => 0.5 - Math.random()).slice(0, 3);
                return selectedResponses;
            };
            
            // KullanÄ±cÄ±nÄ±n onboarding'de girdiÄŸi gerÃ§ek lokasyonu al
            const userLocation = userData?.location || city;
            const userCity = userLocation.split(',')[0].trim(); // Sadece ÅŸehir adÄ±nÄ± al
            
            console.log('KullanÄ±cÄ±nÄ±n ÅŸehri:', userCity);
            console.log('userData:', userData);
            
            // AI iÃ§in prompt oluÅŸtur - gerÃ§ek lokasyon bazlÄ±
            const cuisineText = userCuisines && userCuisines.length > 0 
                ? `KullanÄ±cÄ±nÄ±n sevdiÄŸi mutfaklar: ${userCuisines.join(', ')}` 
                : 'Mutfak tercihi belirtilmemiÅŸ';
            
            const mealTypeTurkish = {
                'kahvaltÄ±': 'kahvaltÄ±',
                'Ã¶ÄŸle yemeÄŸi': 'Ã¶ÄŸle yemeÄŸi',
                'akÅŸam yemeÄŸi': 'akÅŸam yemeÄŸi'
            };
            
            const currentMealType = mealTypeTurkish[mealType] || mealType;
            
            const aiPrompt = `KullanÄ±cÄ± ${userCity} ÅŸehrinde yaÅŸÄ±yor. ${userCity} ÅŸehrinde ${currentMealType} iÃ§in gerÃ§ek restoran Ã¶nerileri istiyorum. ${cuisineText}. 
            
            LÃ¼tfen ${userCity} ÅŸehrinde gerÃ§ekten var olan 3-4 farklÄ± restoran Ã¶ner, her birinin adÄ±nÄ± ve detaylÄ± aÃ§Ä±klamasÄ±nÄ± ver. 
            
            Ã–NEMLÄ°: 
            - Sadece ${userCity} ÅŸehrindeki GERÃ‡EK restoran isimlerini ver
            - Her restoran iÃ§in kÄ±sa ama Ã¶z aÃ§Ä±klama yaz
            - RestoranÄ±n Ã¶zelliklerini, mutfaÄŸÄ±nÄ±, atmosferini belirt
            - Format: "Restoran AdÄ±:\nAÃ§Ä±klama: [DetaylÄ± aÃ§Ä±klama]"
            
            Ã–rnek format:
            "PiÅŸi Breakfast & Burger:
            AÃ§Ä±klama: BeÅŸiktaÅŸ KahvaltÄ±cÄ±lar SokaÄŸÄ±'nda piÅŸi bazlÄ± kahvaltÄ±lar sunan popÃ¼ler mekan."
            
            Sadece ${userCity} ÅŸehrindeki gerÃ§ek restoranlarÄ± ver, baÅŸka aÃ§Ä±klama yapma.`;
            
            // AI'dan Ã¶neri al
            const aiResponse = await generateAIRecommendations(aiPrompt);
            
            if (aiResponse && typeof aiResponse === 'string') {
                // AI yanÄ±tÄ±nÄ± parse et - restoran adÄ± ve aÃ§Ä±klama formatÄ±nda
                const lines = aiResponse.split('\n').filter(line => line.trim());
                const suggestions = [];
                let currentRestaurant = null;
                
                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i].trim();
                    
                    // Restoran adÄ± (AÃ§Ä±klama: ile bitmeyen satÄ±rlar)
                    if (line && !line.startsWith('AÃ§Ä±klama:') && !line.match(/^\d+\./)) {
                        if (currentRestaurant) {
                            suggestions.push(currentRestaurant);
                        }
                        currentRestaurant = {
                            name: line.replace(/^[-â€¢*]\s*/, ''),
                            description: ''
                        };
                    }
                    // AÃ§Ä±klama
                    else if (line.startsWith('AÃ§Ä±klama:') && currentRestaurant) {
                        currentRestaurant.description = line.replace('AÃ§Ä±klama:', '').trim();
                    }
                }
                
                // Son restoranÄ± ekle
                if (currentRestaurant) {
                    suggestions.push(currentRestaurant);
                }
                
                if (suggestions.length > 0) {
                    return suggestions.map(s => `${s.name}:\n${s.description}`);
                }
            }
            
            // Fallback: Statik veriler (API Ã§alÄ±ÅŸmazsa) - KullanÄ±cÄ±nÄ±n lokasyonuna gÃ¶re
            const fallbackRestaurants = {
                'sofya': {
                    kahvaltÄ±: {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'Sultan Sofya:\nGeleneksel TÃ¼rk kahvaltÄ±sÄ±nÄ±n en gÃ¼zel Ã¶rneklerini sunan, sÄ±cak ve samimi atmosferi olan popÃ¼ler bir mekandÄ±r.',
                            'Balkan Evi:\nKarÄ±ÅŸÄ±k kahvaltÄ± tabaÄŸÄ± ve Balkan mutfaÄŸÄ±nÄ±n lezzetlerini sunan, geniÅŸ menÃ¼ seÃ§enekleri olan popÃ¼ler bir mekandÄ±r.',
                            'Ä°stanbul Kafe:\nSerpme kahvaltÄ± ve TÃ¼rk Ã§ayÄ± geleneÄŸini yaÅŸatan, huzurlu bir ortama sahip popÃ¼ler bir mekandÄ±r.'
                        ],
                        'Bulgar': [
                            'Mekitsa & Kafe:\nGeleneksel Bulgar kahvaltÄ±sÄ± ve taze mekitsa Ã§eÅŸitleri sunan, yerel lezzetleri keÅŸfetmek iÃ§in ideal bir mekandÄ±r.',
                            'Banitsa House:\nTaze banitsa ve Ã§ay eÅŸliÄŸinde geleneksel Bulgar kahvaltÄ±sÄ± sunan, sÄ±cak atmosferi olan popÃ¼ler bir mekandÄ±r.',
                            'Sofia Central:\nModern Bulgar kahvaltÄ±sÄ± ve Ã§aÄŸdaÅŸ sunumlarla dikkat Ã§eken, ÅŸehir merkezinde yer alan popÃ¼ler bir mekandÄ±r.'
                        ],
                        'genel': [
                            'Costa Coffee:\nUluslararasÄ± kahvaltÄ± seÃ§enekleri ve kaliteli kahve Ã§eÅŸitleri sunan, modern atmosferi olan popÃ¼ler bir mekandÄ±r.',
                            'Starbucks:\nKlasik kahvaltÄ± seÃ§enekleri ve Ã¶zel kahve Ã§eÅŸitleri sunan, rahat Ã§alÄ±ÅŸma ortamÄ± olan popÃ¼ler bir mekandÄ±r.',
                            'Cafe Central:\nAvrupa tarzÄ± kahvaltÄ± ve pastane Ã¼rÃ¼nleri sunan, ÅŸÄ±k dekorasyonu olan popÃ¼ler bir mekandÄ±r.'
                        ]
                    },
                    'Ã¶ÄŸle yemeÄŸi': {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'KebapÃ§Ä± Ä°skender:\nGeleneksel TÃ¼rk mutfaÄŸÄ±nÄ±n en gÃ¼zel Ã¶rneklerini sunan, Ã¶zellikle kebap Ã§eÅŸitleriyle Ã¼nlÃ¼ popÃ¼ler bir mekandÄ±r.',
                            'Sultan Sofya:\nTÃ¼rk yemekleri ve geleneksel lezzetleri sunan, sÄ±cak atmosferi olan popÃ¼ler bir mekandÄ±r.',
                            'Balkan Evi:\nKarÄ±ÅŸÄ±k Balkan mutfaÄŸÄ± ve Ã§eÅŸitli lezzetler sunan, geniÅŸ menÃ¼ seÃ§enekleri olan popÃ¼ler bir mekandÄ±r.'
                        ],
                        'Bulgar': [
                            'Shtastliveca:\nGeleneksel Bulgar mutfaÄŸÄ±nÄ±n en gÃ¼zel Ã¶rneklerini sunan, yerel lezzetleri keÅŸfetmek iÃ§in ideal bir mekandÄ±r.',
                            'Made in Home:\nModern Bulgar yemekleri ve Ã§aÄŸdaÅŸ sunumlarla dikkat Ã§eken, ÅŸÄ±k dekorasyonu olan popÃ¼ler bir mekandÄ±r.',
                            'Pod Lipite:\nKlasik Bulgar restoranÄ± ve geleneksel lezzetleri sunan, sÄ±cak atmosferi olan popÃ¼ler bir mekandÄ±r.'
                        ],
                        'genel': [
                            'Happy Bar & Grill:\nHÄ±zlÄ± yemek ve Ã§eÅŸitli lezzetler sunan, modern atmosferi olan popÃ¼ler bir mekandÄ±r.',
                            'McDonald\'s:\nFast food ve hÄ±zlÄ± servis sunan, uluslararasÄ± standartlarda popÃ¼ler bir mekandÄ±r.',
                            'Subway:\nSaÄŸlÄ±klÄ± sandviÃ§ler ve taze malzemelerle hazÄ±rlanan yemekler sunan popÃ¼ler bir mekandÄ±r.'
                        ]
                    },
                    'akÅŸam yemeÄŸi': {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'KebapÃ§Ä± Ä°skender:\nAkÅŸam yemeÄŸi iÃ§in Ã¶zel menÃ¼leri ve geleneksel TÃ¼rk mutfaÄŸÄ±nÄ±n en gÃ¼zel Ã¶rneklerini sunan popÃ¼ler bir mekandÄ±r.',
                            'Sultan Sofya:\nTÃ¼rk mutfaÄŸÄ± ve akÅŸam yemeÄŸi lezzetleri sunan, romantik atmosferi olan popÃ¼ler bir mekandÄ±r.',
                            'Balkan Evi:\nAkÅŸam menÃ¼sÃ¼ ve Balkan mutfaÄŸÄ±nÄ±n Ã§eÅŸitli lezzetlerini sunan, sÄ±cak atmosferi olan popÃ¼ler bir mekandÄ±r.'
                        ],
                        'Bulgar': [
                            'Shtastliveca:\nGeleneksel akÅŸam yemeÄŸi ve Bulgar mutfaÄŸÄ±nÄ±n en gÃ¼zel Ã¶rneklerini sunan popÃ¼ler bir mekandÄ±r.',
                            'Made in Home:\nModern akÅŸam menÃ¼sÃ¼ ve Ã§aÄŸdaÅŸ Bulgar yemekleri sunan, ÅŸÄ±k dekorasyonu olan popÃ¼ler bir mekandÄ±r.',
                            'Pod Lipite:\nKlasik akÅŸam yemeÄŸi ve geleneksel Bulgar lezzetleri sunan, sÄ±cak atmosferi olan popÃ¼ler bir mekandÄ±r.'
                        ],
                        'genel': [
                            'Happy Bar & Grill:\nAkÅŸam yemeÄŸi ve Ã§eÅŸitli lezzetler sunan, canlÄ± atmosferi olan popÃ¼ler bir mekandÄ±r.',
                            'Pizza Palace:\nPizza ve pasta Ã§eÅŸitleri sunan, aile ortamÄ± olan popÃ¼ler bir mekandÄ±r.',
                            'Sushi Bar:\nJapon mutfaÄŸÄ± ve sushi Ã§eÅŸitleri sunan, ÅŸÄ±k dekorasyonu olan popÃ¼ler bir mekandÄ±r.'
                        ]
                    }
                },
                'ÅŸiÅŸli': {
                    kahvaltÄ±: {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'Van KahvaltÄ± Evi - NiÅŸantaÅŸÄ±',
                            'Ã‡akÄ±r KahvaltÄ± - Harbiye',
                            'Bebek KahvaltÄ± - Etiler',
                            'Serpme KahvaltÄ± - MaÃ§ka'
                        ],
                        'Ä°talyan': [
                            'Caffe Nero - City\'s NiÅŸantaÅŸÄ±',
                            'Starbucks - Akmerkez',
                            'Caffe Vergnano - TeÅŸvikiye'
                        ],
                        'Uzak DoÄŸu': [
                            'SushiCo - City\'s NiÅŸantaÅŸÄ±',
                            'Wagamama - Akmerkez',
                            'Zuma - Etiler'
                        ],
                        'Meksika': [
                            'Taco Bell - City\'s NiÅŸantaÅŸÄ±',
                            'Chipotle - Akmerkez'
                        ],
                        'Hint': [
                            'Bombay Palace - Harbiye',
                            'Masala - NiÅŸantaÅŸÄ±'
                        ],
                        'genel': [
                            'Kahve DÃ¼nyasÄ± - Harbiye',
                            'Simit SarayÄ± - TeÅŸvikiye',
                            'Cafe Nero - MaÃ§ka'
                        ]
                    },
                    'Ã¶ÄŸle yemeÄŸi': {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'HacÄ± Abdullah - Harbiye',
                            'KebapÃ§Ä± Ä°skender - NiÅŸantaÅŸÄ±',
                            'Ã‡iya SofrasÄ± - Etiler',
                            'Lokma - MaÃ§ka'
                        ],
                        'Ä°talyan': [
                            'Pizza Express - City\'s NiÅŸantaÅŸÄ±',
                            'Vapiano - Akmerkez',
                            'Rossopomodoro - TeÅŸvikiye'
                        ],
                        'Uzak DoÄŸu': [
                            'SushiCo - City\'s NiÅŸantaÅŸÄ±',
                            'Wagamama - Akmerkez',
                            'Zuma - Etiler'
                        ],
                        'Meksika': [
                            'Taco Bell - City\'s NiÅŸantaÅŸÄ±',
                            'Chipotle - Akmerkez'
                        ],
                        'Hint': [
                            'Bombay Palace - Harbiye',
                            'Masala - NiÅŸantaÅŸÄ±'
                        ],
                        'genel': [
                            'Burger King - Harbiye',
                            'McDonald\'s - TeÅŸvikiye',
                            'Subway - MaÃ§ka'
                        ]
                    },
                    'akÅŸam yemeÄŸi': {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'HacÄ± Abdullah - Harbiye',
                            'KebapÃ§Ä± Ä°skender - NiÅŸantaÅŸÄ±',
                            'Ã‡iya SofrasÄ± - Etiler',
                            'Lokma - MaÃ§ka'
                        ],
                        'Ä°talyan': [
                            'Pizza Express - City\'s NiÅŸantaÅŸÄ±',
                            'Vapiano - Akmerkez',
                            'Rossopomodoro - TeÅŸvikiye'
                        ],
                        'Uzak DoÄŸu': [
                            'SushiCo - City\'s NiÅŸantaÅŸÄ±',
                            'Wagamama - Akmerkez',
                            'Zuma - Etiler'
                        ],
                        'Meksika': [
                            'Taco Bell - City\'s NiÅŸantaÅŸÄ±',
                            'Chipotle - Akmerkez'
                        ],
                        'Hint': [
                            'Bombay Palace - Harbiye',
                            'Masala - NiÅŸantaÅŸÄ±'
                        ],
                        'genel': [
                            'Burger King - Harbiye',
                            'McDonald\'s - TeÅŸvikiye',
                            'Subway - MaÃ§ka'
                        ]
                    }
                },
                'kadÄ±kÃ¶y': {
                    kahvaltÄ±: {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'Ã‡iya SofrasÄ± - KadÄ±kÃ¶y',
                            'Van KahvaltÄ± Evi - Moda',
                            'Bebek KahvaltÄ± - FenerbahÃ§e'
                        ],
                        'Ä°talyan': [
                            'Caffe Nero - KadÄ±kÃ¶y',
                            'Starbucks - Moda',
                            'Caffe Vergnano - FenerbahÃ§e'
                        ],
                        'Uzak DoÄŸu': [
                            'SushiCo - KadÄ±kÃ¶y',
                            'Wagamama - Moda',
                            'Zuma - FenerbahÃ§e'
                        ],
                        'genel': [
                            'Kahve DÃ¼nyasÄ± - KadÄ±kÃ¶y',
                            'Simit SarayÄ± - Moda',
                            'Cafe Nero - FenerbahÃ§e'
                        ]
                    },
                    'Ã¶ÄŸle yemeÄŸi': {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'HacÄ± Abdullah - KadÄ±kÃ¶y',
                            'KebapÃ§Ä± Ä°skender - Moda',
                            'Ã‡iya SofrasÄ± - FenerbahÃ§e'
                        ],
                        'Ä°talyan': [
                            'Pizza Express - KadÄ±kÃ¶y',
                            'Vapiano - Moda',
                            'Rossopomodoro - FenerbahÃ§e'
                        ],
                        'genel': [
                            'Burger King - KadÄ±kÃ¶y',
                            'McDonald\'s - Moda',
                            'Subway - FenerbahÃ§e'
                        ]
                    },
                    'akÅŸam yemeÄŸi': {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'HacÄ± Abdullah - KadÄ±kÃ¶y',
                            'KebapÃ§Ä± Ä°skender - Moda',
                            'Ã‡iya SofrasÄ± - FenerbahÃ§e'
                        ],
                        'Ä°talyan': [
                            'Pizza Express - KadÄ±kÃ¶y',
                            'Vapiano - Moda',
                            'Rossopomodoro - FenerbahÃ§e'
                        ],
                        'genel': [
                            'Burger King - KadÄ±kÃ¶y',
                            'McDonald\'s - Moda',
                            'Subway - FenerbahÃ§e'
                        ]
                    }
                },
                'beÅŸiktaÅŸ': {
                    kahvaltÄ±: {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'Van KahvaltÄ± Evi - BeÅŸiktaÅŸ',
                            'Ã‡akÄ±r KahvaltÄ± - OrtakÃ¶y',
                            'Bebek KahvaltÄ± - Bebek'
                        ],
                        'Ä°talyan': [
                            'Caffe Nero - BeÅŸiktaÅŸ',
                            'Starbucks - OrtakÃ¶y',
                            'Caffe Vergnano - Bebek'
                        ],
                        'genel': [
                            'Kahve DÃ¼nyasÄ± - BeÅŸiktaÅŸ',
                            'Simit SarayÄ± - OrtakÃ¶y',
                            'Cafe Nero - Bebek'
                        ]
                    },
                    'Ã¶ÄŸle yemeÄŸi': {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'HacÄ± Abdullah - BeÅŸiktaÅŸ',
                            'KebapÃ§Ä± Ä°skender - OrtakÃ¶y',
                            'Ã‡iya SofrasÄ± - Bebek'
                        ],
                        'genel': [
                            'Burger King - BeÅŸiktaÅŸ',
                            'McDonald\'s - OrtakÃ¶y',
                            'Subway - Bebek'
                        ]
                    },
                    'akÅŸam yemeÄŸi': {
                        'TÃ¼rk MutfaÄŸÄ±': [
                            'HacÄ± Abdullah - BeÅŸiktaÅŸ',
                            'KebapÃ§Ä± Ä°skender - OrtakÃ¶y',
                            'Ã‡iya SofrasÄ± - Bebek'
                        ],
                        'genel': [
                            'Burger King - BeÅŸiktaÅŸ',
                            'McDonald\'s - OrtakÃ¶y',
                            'Subway - Bebek'
                        ]
                    }
                },
                'genel': {
                    kahvaltÄ±: {
                        'genel': [
                            `KahvaltÄ± Evi:\n${userCity} ÅŸehrinde taze malzemelerle hazÄ±rlanan geleneksel kahvaltÄ± lezzetleri sunan, sÄ±cak ve samimi atmosferi olan popÃ¼ler bir mekandÄ±r.`,
                            `Modern Kafe:\n${userCity} ÅŸehrinde uluslararasÄ± kahvaltÄ± seÃ§enekleri ve kaliteli kahve Ã§eÅŸitleri sunan, Ã§aÄŸdaÅŸ tasarÄ±mÄ± olan popÃ¼ler bir mekandÄ±r.`,
                            `Geleneksel Restoran:\n${userCity} ÅŸehrinde yerel mutfaÄŸÄ±n en gÃ¼zel Ã¶rneklerini sunan, otantik atmosferi olan popÃ¼ler bir mekandÄ±r.`
                        ]
                    },
                    'Ã¶ÄŸle yemeÄŸi': {
                        'genel': [
                            `Yerel Lokanta:\n${userCity} ÅŸehrinde hÄ±zlÄ± servis ve ev yemekleri sunan, uygun fiyatlÄ± popÃ¼ler bir mekandÄ±r.`,
                            `Modern Restoran:\n${userCity} ÅŸehrinde saÄŸlÄ±klÄ± seÃ§enekler ve Ã§aÄŸdaÅŸ lezzetler sunan, ÅŸÄ±k dekorasyonu olan popÃ¼ler bir mekandÄ±r.`,
                            `Aile RestoranÄ±:\n${userCity} ÅŸehrinde ev yapÄ±mÄ± yemekler ve geniÅŸ menÃ¼ seÃ§enekleri sunan, sÄ±cak atmosferi olan popÃ¼ler bir mekandÄ±r.`
                        ]
                    },
                    'akÅŸam yemeÄŸi': {
                        'genel': [
                            `Fine Dining Restoran:\n${userCity} ÅŸehrinde Ã¶zel akÅŸam yemeÄŸi menÃ¼leri ve ÅŸÄ±k sunumlarÄ±yla dikkat Ã§eken, romantik atmosferi olan popÃ¼ler bir mekandÄ±r.`,
                            `Geleneksel Restoran:\n${userCity} ÅŸehrinde yerel mutfaÄŸÄ±n en gÃ¼zel Ã¶rneklerini sunan, otantik atmosferi olan popÃ¼ler bir mekandÄ±r.`,
                            `Modern Restoran:\n${userCity} ÅŸehrinde Ã§aÄŸdaÅŸ lezzetler ve yenilikÃ§i mutfak teknikleriyle hazÄ±rlanan yemekler sunan popÃ¼ler bir mekandÄ±r.`
                        ]
                    }
                }
            };
            
            // Åehir kontrolÃ¼ ve Ã¶neri seÃ§imi
            const cityLower = city.toLowerCase();
            let cityKey = 'genel'; // varsayÄ±lan
            
            if (cityLower.includes('sofya') || cityLower.includes('sofia') || cityLower.includes('bulgaristan') || cityLower.includes('bulgaria')) {
                cityKey = 'sofya';
            } else if (cityLower.includes('ÅŸiÅŸli') || cityLower.includes('niÅŸantaÅŸÄ±') || cityLower.includes('harbiye') || cityLower.includes('teÅŸvikiye') || cityLower.includes('maÃ§ka')) {
                cityKey = 'ÅŸiÅŸli';
            } else if (cityLower.includes('kadÄ±kÃ¶y') || cityLower.includes('moda') || cityLower.includes('fenerbahÃ§e')) {
                cityKey = 'kadÄ±kÃ¶y';
            } else if (cityLower.includes('beÅŸiktaÅŸ') || cityLower.includes('ortakÃ¶y') || cityLower.includes('bebek')) {
                cityKey = 'beÅŸiktaÅŸ';
            } else {
                // Bilinmeyen ÅŸehir iÃ§in genel Ã¶neriler
                cityKey = 'genel';
            }
            
            const cityRestaurants = fallbackRestaurants[cityKey] || fallbackRestaurants['genel'];
            const mealRestaurants = cityRestaurants[mealType] || cityRestaurants.kahvaltÄ±;
            
            // KullanÄ±cÄ±nÄ±n tercih ettiÄŸi mutfaklara gÃ¶re Ã¶neri seÃ§
            let suggestions = [];
            
            if (userCuisines && userCuisines.length > 0) {
                // KullanÄ±cÄ±nÄ±n tercih ettiÄŸi mutfaklardan Ã¶neri seÃ§
                for (const cuisine of userCuisines) {
                    if (mealRestaurants[cuisine]) {
                        suggestions = suggestions.concat(mealRestaurants[cuisine].slice(0, 2));
                    }
                }
                
                // EÄŸer yeterli Ã¶neri yoksa genel kategoriden ekle
                if (suggestions.length < 3) {
                    suggestions = suggestions.concat(mealRestaurants.genel.slice(0, 3 - suggestions.length));
                }
            } else {
                // Tercih yoksa genel kategoriden seÃ§
                suggestions = mealRestaurants.genel.slice(0, 3);
            }
            
            // Benzersiz Ã¶neriler dÃ¶ndÃ¼r
            const finalSuggestions = [...new Set(suggestions)].slice(0, 4);
            console.log('Final restoran Ã¶nerileri:', finalSuggestions);
            return finalSuggestions;
            
        } catch (error) {
            console.error('Restoran Ã¶neri hatasÄ±:', error);
            // Hata durumunda genel Ã¶neriler
            return [
                `${city} bÃ¶lgesinde PopÃ¼ler Restoran - Yerel Lezzetler`,
                `${city} bÃ¶lgesinde Geleneksel Mutfak - Klasik Yemekler`,
                `${city} bÃ¶lgesinde Modern Kafe - Ã‡aÄŸdaÅŸ SeÃ§enekler`,
                `${city} bÃ¶lgesinde Aile RestoranÄ± - SÄ±cak Ortam`
            ];
        }
    };
            
            // Generate AI tasks based on user data
            const generateAITasks = (userData, dateKey) => {
                if (!userData) return [];
                
                const targetDate = new Date(dateKey + 'T00:00:00');
                const todayName = targetDate.toLocaleString('tr-TR', { weekday: 'long' });
                const isWeekend = todayName === 'Cumartesi' || todayName === 'Pazar';
                
                let generatedTasks = [];
                
                // Yemek gÃ¶revleri
                if (userData.breakfastTime) {
                    const suggestionType = userData.breakfastPreference || 'home';
                    let suggestionDetail = suggestionType === 'home' 
                        ? 'PlanIQ, kahvaltÄ±nÄ± evde yapacaÄŸÄ±nÄ± biliyor. GÃ¼ne enerjik baÅŸlamak iÃ§in omlet, menemen veya saÄŸlÄ±klÄ± bir yulaf ezmesi deneyebilirsin!'
                        : `PlanIQ, kahvaltÄ±nÄ± dÄ±ÅŸarÄ±da yapacaÄŸÄ±nÄ± biliyor. ${userData.city || 'YakÄ±nlarÄ±ndaki'} bÃ¶lgedeki popÃ¼ler bir pastaneden poÄŸaÃ§a/bÃ¶rek alabilir veya gÃ¼zel bir serpme kahvaltÄ± mekanÄ±nÄ± deneyebilirsin.`;
                    
                    generatedTasks.push({
                        id: `ai_breakfast_${dateKey}`,
                        time: userData.breakfastTime,
                        name: "KahvaltÄ±",
                        status: "PlanlandÄ±",
                        isAISuggestion: true,
                        suggestionDetail: suggestionDetail,
                        suggestionType: suggestionType
                    });
                }
                
                if (userData.lunchTime) {
                    const suggestionType = userData.lunchPreference || 'home';
                    let suggestionDetail = suggestionType === 'home'
                        ? 'Ã–ÄŸle yemeÄŸi iÃ§in evdesin! HÄ±zlÄ± bir sandviÃ§, pratik bir salata veya dÃ¼nden kalan lezzetli bir yemeÄŸi Ä±sÄ±tabilirsin.'
                        : `Ã–ÄŸle yemeÄŸi dÄ±ÅŸarÄ±da! ${userData.city || 'YakÄ±nlarÄ±ndaki'} bÃ¶lgedeki bir esnaf lokantasÄ±, kafe veya sevdiÄŸin bir restorana ne dersin?`;
                    
                    generatedTasks.push({
                        id: `ai_lunch_${dateKey}`,
                        time: userData.lunchTime,
                        name: "Ã–ÄŸle YemeÄŸi",
                        status: "PlanlandÄ±",
                        isAISuggestion: true,
                        suggestionDetail: suggestionDetail,
                        suggestionType: suggestionType
                    });
                }
                
                if (userData.dinnerTime && userData.cuisines && userData.cuisines.length > 0) {
                    let randomCuisine = userData.cuisines[Math.floor(Math.random() * userData.cuisines.length)];
                    const suggestionType = userData.dinnerPreference || 'home';
                    let suggestionDetail = '';
                    
                    if (suggestionType === 'outside') {
                        suggestionDetail = `PlanIQ, ${randomCuisine} mutfaÄŸÄ±nÄ± sevdiÄŸini fark etti. AkÅŸam yemeÄŸi iÃ§in ${userData.city || 'yakÄ±nlardaki'} bÃ¶lgede popÃ¼ler bir ${randomCuisine} restoranÄ±nÄ± keÅŸfetmeye ne dersin?`;
                    } else {
                        suggestionDetail = `PlanIQ, ${randomCuisine} mutfaÄŸÄ±nÄ± sevdiÄŸini fark etti. AkÅŸam yemeÄŸini evde yiyeceÄŸini belirttin, gÃ¼zel bir ${randomCuisine.toLowerCase()} yemeÄŸi yapmaya ne dersin?`;
                    }
                    
                    generatedTasks.push({
                        id: `ai_dinner_${dateKey}`,
                        time: userData.dinnerTime,
                        name: `AkÅŸam YemeÄŸi: ${randomCuisine}`,
                        status: "PlanlandÄ±",
                        isAISuggestion: true,
                        suggestionDetail: suggestionDetail,
                        suggestionType: suggestionType
                    });
                }
                
                // Rutin gÃ¶revler
                generatedTasks.push({
                    id: `routine_wake_${dateKey}`,
                    time: (isWeekend ? userData.weekendWakeTime : userData.weekdayWakeTime) || "08:00",
                    name: "Uyan & GÃ¼ne BaÅŸla",
                    status: "PlanlandÄ±",
                    isRoutine: true
                });
                
                generatedTasks.push({
                    id: `routine_sleep_${dateKey}`,
                    time: (isWeekend ? userData.weekendSleepTime : userData.weekdaySleepTime) || "23:00",
                    name: "Uyku ZamanÄ±",
                    status: "PlanlandÄ±",
                    isRoutine: true
                });
                
                // Aktivite Ã¶nerisi
                if (userData.activities && userData.activities.length > 0) {
                    const randomActivity = userData.activities[Math.floor(Math.random() * userData.activities.length)];
                    const dinnerTime = userData.dinnerTime || "19:00";
                    let activityTime = addMinutesToTime(dinnerTime, 90);
                    
                    let suggestionDetail = '';
                    if (randomActivity.includes('Spor')) {
                        activityTime = addMinutesToTime(dinnerTime, -60);
                        suggestionDetail = `PlanIQ, ${randomActivity} yapmayÄ± sevdiÄŸini biliyor. ${activityTime} civarÄ± bunun iÃ§in iyi bir zaman olabilir!`;
                    } else if (randomActivity.includes('Sinema')) {
                        suggestionDetail = `PlanIQ, sinemaya gitmeyi sevdiÄŸini biliyor! AkÅŸam iÃ§in film Ã¶nerisi almak ister misin?`;
                    } else {
                        suggestionDetail = `PlanIQ, ${randomActivity} yapmayÄ± sevdiÄŸini biliyor. AkÅŸam yemeÄŸinden sonra ${activityTime} civarÄ± bunun iÃ§in iyi bir zaman olabilir!`;
                    }
                    
                    generatedTasks.push({
                        id: `ai_activity_${dateKey}`,
                        time: activityTime,
                        name: `${randomActivity} ZamanÄ±`,
                        status: "PlanlandÄ±",
                        isAISuggestion: true,
                        suggestionDetail: suggestionDetail,
                        suggestionType: 'activity'
                    });
                }
                
                return generatedTasks.sort((a, b) => a.time.localeCompare(b.time));
            };
            
            useEffect(() => {
                if (userData && selectedDateKey) {
                    const aiTasks = generateAITasks(userData, selectedDateKey);
                    
                    // Schedule gÃ¶revlerini ekle (eÄŸer varsa)
                    let scheduleTasks = [];
                    if (userData.scheduleTasks) {
                        const today = new Date(selectedDateKey + 'T00:00:00');
                        const dayNames = ['Pazar', 'Pazartesi', 'SalÄ±', 'Ã‡arÅŸamba', 'PerÅŸembe', 'Cuma', 'Cumartesi'];
                        const todayName = dayNames[today.getDay()];
                        
                        scheduleTasks = userData.scheduleTasks.filter(task => 
                            task.dayOfWeek === todayName && task.isRecurring
                        ).map(task => ({
                            ...task,
                            id: `${task.id}-${selectedDateKey}` // Benzersiz ID iÃ§in tarih ekle
                        }));
                    }
                    
                    // TÃ¼m gÃ¶revleri birleÅŸtir ve sÄ±rala
                    const allTasks = [...aiTasks, ...scheduleTasks].sort((a, b) => a.time.localeCompare(b.time));
                    setTasks(allTasks);
                    setIsLoadingTasks(false);
                }
            }, [userData, selectedDateKey]);
            
            const toggleTaskStatus = (taskId, currentStatus) => {
                setTasks(prevTasks => 
                    prevTasks.map(task => 
                        task.id === taskId 
                            ? { ...task, status: currentStatus === 'TamamlandÄ±' ? 'PlanlandÄ±' : 'TamamlandÄ±' }
                            : task
                    )
                );
            };
            
            const deleteTask = (taskId) => {
                setTasks(prevTasks => prevTasks.filter(task => task.id !== taskId));
            };
            
            const addTask = async () => {
                if (!newTask.time || !newTask.name) return;
                
                const newTaskObj = {
                    id: `manual_${Date.now()}`,
                    time: newTask.time,
                    name: newTask.name,
                    status: 'PlanlandÄ±',
                    isAISuggestion: false,
                    isRoutine: false
                };
                
                setTasks(prevTasks => [...prevTasks, newTaskObj].sort((a, b) => a.time.localeCompare(b.time)));
                setNewTask({ time: '', name: '' });
                setIsAddingTask(false);
            };
            
            const getStatusColor = (status) => {
                if (isDark) {
                    const colors = {
                        'TamamlandÄ±': 'bg-green-900/50 text-green-300 border-green-700',
                        'PlanlandÄ±': 'bg-blue-900/50 text-blue-300 border-blue-700',
                        'Beklemede': 'bg-yellow-900/50 text-yellow-300 border-yellow-700'
                    };
                    return colors[status] || 'bg-gray-700 text-gray-300 border-gray-600';
                } else {
                    const colors = {
                        'TamamlandÄ±': 'bg-green-100 text-green-700 border-green-300',
                        'PlanlandÄ±': 'bg-blue-100 text-blue-700 border-blue-300',
                        'Beklemede': 'bg-yellow-100 text-yellow-700 border-yellow-300'
                    };
                    return colors[status] || 'bg-gray-100 text-gray-700 border-gray-300';
                }
            };
            
            const significantTasks = tasks.filter(task => !task.isRoutine);
            const totalSignificantTasks = significantTasks.length;
            const completedSignificantTasks = significantTasks.filter(t => t.status === 'TamamlandÄ±').length;
            const completionPercentage = Math.round((completedSignificantTasks / (totalSignificantTasks || 1)) * 100);
            
            const fullDateString = formatFullDate(new Date(selectedDateKey + 'T00:00:00'));
            
            return React.createElement('div', {
                className: `${isDark ? 'bg-gray-800' : 'bg-white'} rounded-3xl shadow-2xl overflow-hidden transition-colors duration-300`
            }, [
                // Header
                React.createElement('div', {
                    key: 'header',
                    className: `relative overflow-hidden ${isDark ? 'bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900' : 'bg-gradient-to-br from-purple-600 via-purple-500 to-pink-500'} p-6 sm:p-8 transition-all duration-300`
                }, [
                    React.createElement('div', {
                        key: 'bubbles',
                        className: "absolute inset-0 opacity-10"
                    }, [
                        React.createElement('div', {
                            key: 'bubble1',
                            className: "absolute top-0 left-0 w-64 h-64 bg-white rounded-full blur-3xl transform -translate-x-1/2 -translate-y-1/2"
                        }),
                        React.createElement('div', {
                            key: 'bubble2',
                            className: "absolute bottom-0 right-0 w-64 h-64 bg-white rounded-full blur-3xl transform translate-x-1/2 translate-y-1/2"
                        })
                    ]),
                    React.createElement('div', {
                        key: 'content',
                        className: "relative z-10"
                    }, [
                        React.createElement('div', {
                            key: 'title',
                            className: "flex items-center justify-between mb-4"
                        }, [
                            React.createElement('div', {
                                key: 'date',
                                className: ""
                            }, [
                                React.createElement('h2', {
                                    key: 'day',
                                    className: "text-4xl font-bold text-white"
                                }, day),
                                React.createElement('p', {
                                    key: 'fullDate',
                                    className: "text-white/80 font-medium"
                                }, fullDateString)
                            ]),
                            React.createElement('div', {
                                key: 'counter',
                                className: `flex items-center gap-2 px-4 py-2 ${isDark ? 'bg-white/10' : 'bg-white/20'} backdrop-blur-sm rounded-full`
                            }, [
                                React.createElement('span', {
                                    key: 'icon',
                                    className: "text-white"
                                }, 'â°'),
                                React.createElement('span', {
                                    key: 'count',
                                    className: "text-white font-semibold text-sm"
                                }, `${completedSignificantTasks}/${totalSignificantTasks} GÃ¶rev`)
                            ])
                        ]),
                        React.createElement('div', {
                            key: 'progress',
                            className: "flex items-center gap-3"
                        }, [
                            React.createElement('span', {
                                key: 'status',
                                className: `px-4 py-1.5 rounded-full text-sm font-semibold ${isDark ? 'bg-gray-700 text-gray-200 border-gray-600' : 'bg-blue-100 text-blue-700 border-blue-300'} shadow-lg border`
                            }, totalSignificantTasks === 0 ? 'Rutin GÃ¼n' : totalSignificantTasks <= 2 ? 'Hafif GÃ¼n' : totalSignificantTasks <= 4 ? 'Normal GÃ¼n' : 'YoÄŸun GÃ¼n'),
                            React.createElement('div', {
                                key: 'bar',
                                className: `flex-1 h-2.5 ${isDark ? 'bg-white/10' : 'bg-white/20'} rounded-full overflow-hidden backdrop-blur-sm`
                            }, React.createElement('div', {
                                className: "h-full bg-white transition-all duration-500 rounded-full",
                                style: { width: `${completionPercentage}%` }
                            })),
                            React.createElement('span', {
                                key: 'percentage',
                                className: "text-white font-bold text-sm w-12 text-right"
                            }, `%${completionPercentage}`)
                        ])
                    ])
                ]),
                
                // Tasks List
                React.createElement('div', {
                    key: 'tasks',
                    className: `p-6 space-y-3 max-h-96 overflow-y-auto ${isDark ? 'bg-gray-800' : ''}`
                }, [
                    isLoadingTasks ? React.createElement('div', {
                        key: 'loading',
                        className: "flex justify-center items-center py-10"
                    }, React.createElement('div', {
                        className: `w-8 h-8 ${isDark ? 'text-purple-300' : 'text-purple-600'} animate-spin`
                    }, 'â³')) : null,
                    
                    !isLoadingTasks && tasks.length === 0 ? React.createElement('p', {
                        key: 'empty',
                        className: `text-center py-10 ${isDark ? 'text-gray-400' : 'text-gray-500'}`
                    }, 'Bu tarih iÃ§in planlanmÄ±ÅŸ gÃ¶rev yok.') : null,
                    
                    !isLoadingTasks && tasks.map((task) => 
                        React.createElement('div', {
                            key: task.id,
                            className: `p-4 rounded-xl border-2 ${getStatusColor(task.status)} backdrop-blur-sm transition-all hover:scale-102 hover:shadow-md ${task.isAISuggestion ? 'cursor-pointer' : ''}`,
                            onClick: () => task.isAISuggestion && setModalTask(task)
                        }, [
                            React.createElement('div', {
                                key: 'content',
                                className: "flex items-center justify-between"
                            }, [
                                React.createElement('div', {
                                    key: 'left',
                                    className: "flex items-center gap-3 flex-1"
                                }, [
                                    React.createElement('button', {
                                        key: 'toggle',
                                        onClick: (e) => {
                                            e.stopPropagation();
                                            toggleTaskStatus(task.id, task.status);
                                        },
                                        className: "flex-shrink-0 transition-transform hover:scale-110"
                                    }, task.status === 'TamamlandÄ±' ? 'âœ…' : 'â­•'),
                                    React.createElement('div', {
                                        key: 'info',
                                        className: "flex-1 min-w-0"
                                    }, [
                                        React.createElement('div', {
                                            key: 'time',
                                            className: `flex items-center gap-2 mb-1 ${isDark ? 'text-gray-400' : 'text-gray-600'}`
                                        }, [
                                            React.createElement('span', {
                                                key: 'clock',
                                                className: "text-sm"
                                            }, 'â°'),
                                            React.createElement('span', {
                                                key: 'time',
                                                className: "text-sm font-semibold"
                                            }, task.time),
                                            task.isAISuggestion && React.createElement('span', {
                                                key: 'ai',
                                                className: "text-sm"
                                            }, 'âœ¨')
                                        ]),
                                        React.createElement('div', {
                                            key: 'name',
                                            className: "flex items-center gap-2"
                                        }, [
                                            task.category === 'schedule' && React.createElement('span', {
                                                key: 'icon',
                                                className: "text-sm"
                                            }, task.type === 'school' ? 'ğŸ“' : 'ğŸ’¼'),
                                            React.createElement('p', {
                                                key: 'text',
                                                className: `font-medium truncate ${isDark ? 'text-gray-100' : 'text-gray-800'} ${task.status === 'TamamlandÄ±' ? 'line-through opacity-60' : ''}`
                                            }, task.name),
                                            task.category === 'schedule' && React.createElement('span', {
                                                key: 'badge',
                                                className: `px-2 py-0.5 text-xs rounded-full font-medium ${isDark ? 'bg-blue-900/50 text-blue-300' : 'bg-blue-100 text-blue-800'}`
                                            }, 'Sabit')
                                        ])
                                    ])
                                ]),
                                task.category !== 'schedule' && React.createElement('button', {
                                    key: 'delete',
                                    onClick: (e) => {
                                        e.stopPropagation();
                                        deleteTask(task.id);
                                    },
                                    className: `ml-2 p-2 flex-shrink-0 ${isDark ? 'hover:bg-red-900/50' : 'hover:bg-red-100'} rounded-lg transition-colors`
                                }, 'ğŸ—‘ï¸')
                            ])
                        ])
                    )
                ]),
                
                // Add Task Form
                React.createElement('div', {
                    key: 'addForm',
                    className: `p-6 border-t ${isDark ? 'border-gray-700' : 'border-gray-100'}`
                }, isAddingTask ? [
                    React.createElement('div', {
                        key: 'form',
                        className: "space-y-3"
                    }, [
                        React.createElement('input', {
                            key: 'time',
                            type: "time",
                            value: newTask.time,
                            onChange: (e) => setNewTask({ ...newTask, time: e.target.value }),
                            className: `w-full px-4 py-2 rounded-lg border-2 ${isDark ? 'bg-gray-700 border-gray-600 text-white' : 'bg-gray-50 border-gray-300 text-gray-800'}`
                        }),
                        React.createElement('input', {
                            key: 'name',
                            type: "text",
                            placeholder: "GÃ¶rev adÄ±...",
                            value: newTask.name,
                            onChange: (e) => setNewTask({ ...newTask, name: e.target.value }),
                            className: `w-full px-4 py-2 rounded-lg border-2 ${isDark ? 'bg-gray-700 border-gray-600 text-white' : 'bg-gray-50 border-gray-300 text-gray-800'}`
                        }),
                        React.createElement('div', {
                            key: 'buttons',
                            className: "flex gap-2"
                        }, [
                            React.createElement('button', {
                                key: 'cancel',
                                onClick: () => setIsAddingTask(false),
                                className: `w-full py-2 px-4 rounded-lg ${isDark ? 'bg-gray-600 hover:bg-gray-500 text-white' : 'bg-gray-200 hover:bg-gray-300 text-gray-700'} text-sm font-semibold transition-colors`
                            }, 'Ä°ptal'),
                            React.createElement('button', {
                                key: 'add',
                                onClick: addTask,
                                className: "w-full py-2 px-4 rounded-lg bg-purple-600 text-white hover:bg-purple-700 text-sm font-semibold transition-colors"
                            }, 'Ekle')
                        ])
                    ])
                ] : React.createElement('button', {
                    key: 'addButton',
                    onClick: () => setIsAddingTask(true),
                    className: `w-full flex items-center justify-center gap-2 py-3 border-2 ${isDark ? 'border-purple-700 text-purple-300 hover:bg-purple-900/50' : 'border-dashed border-purple-300 text-purple-600 hover:bg-purple-50'} rounded-xl transition-all`
                }, ['â•', 'Yeni GÃ¶rev Ekle'])),
                
                // AI Suggestion Modal
                modalTask && React.createElement('div', {
                    key: 'modal',
                    className: "fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-fadeIn",
                    onClick: () => {
                        setModalTask(null);
                        setModalContentStage('initial');
                        setAiSuggestionContent(null);
                    }
                }, React.createElement('div', {
                    className: `rounded-3xl shadow-2xl overflow-hidden ${isDark ? 'bg-gray-800' : 'bg-white'} max-w-lg w-full transform transition-all animate-slideUp`,
                    onClick: (e) => e.stopPropagation()
                }, [
                    React.createElement('div', {
                        key: 'modalHeader',
                        className: `relative overflow-hidden ${isDark ? 'bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900' : 'bg-gradient-to-br from-purple-600 via-purple-500 to-pink-500'} p-6`
                    }, [
                        React.createElement('div', {
                            key: 'title',
                            className: "flex items-center gap-3"
                        }, ['âœ¨', React.createElement('h3', {
                            key: 'text',
                            className: "text-2xl font-bold text-white"
                        }, 'PlanIQ Ã–nerisi')])
                    ]),
                    React.createElement('div', {
                        key: 'modalContent',
                        className: "p-6 space-y-4 min-h-[150px]"
                    }, [
                        React.createElement('p', {
                            key: 'taskName',
                            className: `text-lg font-semibold ${isDark ? 'text-white' : 'text-gray-900'}`
                        }, modalTask.name),
                        
                        // State makinesi ile iÃ§erik kontrolÃ¼
                        modalContentStage === 'loading' ? React.createElement('div', {
                            key: 'loading',
                            className: "flex items-center justify-center py-8"
                        }, [
                            React.createElement('div', {
                                key: 'spinner',
                                className: "animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"
                            }),
                            React.createElement('span', {
                                key: 'text',
                                className: `ml-3 ${isDark ? 'text-white' : 'text-gray-700'}`
                            }, 'AI Ã¶nerileri hazÄ±rlanÄ±yor...')
                        ]) : modalContentStage === 'recipe' ? React.createElement('div', {
                            key: 'recipeContent',
                            className: "space-y-4"
                        }, [
                            React.createElement('h4', {
                                key: 'title',
                                className: `text-lg font-bold ${isDark ? 'text-white' : 'text-gray-900'} flex items-center gap-2`
                            }, ['ğŸ³', 'Tarif Ã–nerileri']),
                            React.createElement('div', {
                                key: 'suggestions',
                                className: "space-y-4"
                            }, aiSuggestionContent && Array.isArray(aiSuggestionContent) ? aiSuggestionContent.map((recipe, index) => {
                                const [name, description] = recipe.split(':\n');
                                return React.createElement('div', {
                                    key: index,
                                    className: `p-4 rounded-lg ${isDark ? 'bg-gray-700' : 'bg-gray-100'}`
                                }, [
                                    React.createElement('div', {
                                        key: 'header',
                                        className: "flex items-center gap-2 mb-2"
                                    }, [
                                        React.createElement('span', { key: 'icon' }, 'ğŸ‘¨â€ğŸ³'),
                                        React.createElement('h4', {
                                            key: 'name',
                                            className: `${isDark ? 'text-white' : 'text-gray-800'} font-bold text-lg`
                                        }, name)
                                    ]),
                                    React.createElement('p', {
                                        key: 'description',
                                        className: `${isDark ? 'text-gray-300' : 'text-gray-600'} text-sm leading-relaxed`
                                    }, description)
                                ]);
                            }) : [])
                        ]) : modalContentStage === 'restaurant' ? React.createElement('div', {
                            key: 'restaurantContent',
                            className: "space-y-4"
                        }, [
                            React.createElement('h4', {
                                key: 'title',
                                className: `text-lg font-bold ${isDark ? 'text-white' : 'text-gray-900'} flex items-center gap-2`
                            }, ['ğŸ½ï¸', 'Restoran Ã–nerileri']),
                            React.createElement('div', {
                                key: 'suggestions',
                                className: "space-y-4"
                            }, aiSuggestionContent && Array.isArray(aiSuggestionContent) ? aiSuggestionContent.map((restaurant, index) => {
                                const [name, description] = restaurant.split(':\n');
                                return React.createElement('div', {
                                    key: index,
                                    className: `p-4 rounded-lg ${isDark ? 'bg-gray-700' : 'bg-gray-100'}`
                                }, [
                                    React.createElement('div', {
                                        key: 'header',
                                        className: "flex items-center gap-2 mb-2"
                                    }, [
                                        React.createElement('span', { key: 'icon' }, 'ğŸ“'),
                                        React.createElement('h4', {
                                            key: 'name',
                                            className: `${isDark ? 'text-white' : 'text-gray-800'} font-bold text-lg`
                                        }, name)
                                    ]),
                                    React.createElement('p', {
                                        key: 'description',
                                        className: `${isDark ? 'text-gray-300' : 'text-gray-600'} text-sm leading-relaxed`
                                    }, description)
                                ]);
                            }) : [])
                        ]) : React.createElement('p', {
                            key: 'suggestion',
                            className: `${isDark ? 'text-gray-300